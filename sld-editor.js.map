{"version":3,"file":"sld-editor.js","sourceRoot":"","sources":["../sld-editor.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, LitElement } from 'lit';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { customElement, property, state } from 'lit/decorators.js';\nimport { newEditEventV2 } from '@openscd/oscd-api/utils.js';\nimport { EditV2, SetAttributes } from '@openscd/oscd-api';\nimport { getReference } from '@openscd/oscd-scl';\n\nimport './sld-substation-editor.js';\n\nimport {\n  attributes,\n  busSections,\n  ConnectDetail,\n  ConnectEvent,\n  elementPath,\n  getSLDAttributes,\n  isBusBar,\n  PlaceEvent,\n  PlaceLabelEvent,\n  Point,\n  privType,\n  removeNode,\n  removeTerminal,\n  reparentElement,\n  ResizeEvent,\n  ResizeTLEvent,\n  setSLDAttributes,\n  sldNs,\n  StartConnectDetail,\n  StartConnectEvent,\n  StartEvent,\n  StartPlaceEvent,\n  updateSLDAttributes,\n  uuid,\n  xmlnsNs,\n} from './util.js';\n\nfunction cutSectionAt(\n  section: Element,\n  index: number,\n  [x, y]: Point,\n  nsPrefix: string\n): EditV2[] {\n  const parent = section.parentElement!;\n  const edits = [] as EditV2[];\n  const vertices = Array.from(section.getElementsByTagNameNS(sldNs, 'Vertex'));\n  const vertexAtXY = vertices.find(\n    ve =>\n      getSLDAttributes(ve, 'x') === x.toString() &&\n      getSLDAttributes(ve, 'y') === y.toString()\n  );\n\n  if (\n    vertexAtXY === vertices[0] ||\n    vertexAtXY === vertices[vertices.length - 1]\n  )\n    return [];\n\n  const newSection = section.cloneNode(true) as Element;\n  Array.from(newSection.getElementsByTagNameNS(sldNs, 'Vertex'))\n    .slice(0, index + 1)\n    .forEach(vertex => vertex.remove());\n  const v = vertices[index].cloneNode() as Element;\n  setSLDAttributes(v, nsPrefix, { x: x.toString(), y: y.toString() });\n  v.removeAttributeNS(sldNs, 'uuid');\n  newSection.prepend(v);\n  edits.push({\n    node: newSection,\n    parent,\n    reference: section.nextElementSibling,\n  });\n\n  vertices.slice(index + 1).forEach(vertex => edits.push({ node: vertex }));\n\n  if (!vertexAtXY) {\n    const v2 = v.cloneNode();\n    edits.push({ node: v2, parent: section, reference: null });\n  }\n\n  return edits;\n}\n\n@customElement('sld-editor')\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport class SldEditor extends LitElement {\n  @property() doc!: XMLDocument;\n\n  @property()\n  get docVersion(): number {\n    return this._docVersion;\n  }\n\n  set docVersion(value: number) {\n    this.connecting = undefined;\n    if (!this.resizingBR?.parentElement) this.resizingBR = undefined;\n    if (!this.placingLabel?.parentElement) this.placingLabel = undefined;\n    this._docVersion = value;\n  }\n\n  @state()\n  private _docVersion = -1;\n\n  @property({ type: Boolean }) disabled = false;\n\n  @state() gridSize = 32;\n\n  @state() nsp = 'eoscd';\n\n  @state() resizingBR?: Element;\n\n  @state() resizingTL?: Element;\n\n  @state() placing?: Element;\n\n  @state() placingOffset: Point = [0, 0];\n\n  @state() placingLabel?: Element;\n\n  @state() showLabels: boolean = true;\n\n  @state()\n  connecting?: {\n    from: Element;\n    path: Point[];\n    fromTerminal: 'T1' | 'T2' | 'N1' | 'N2';\n  };\n\n  handleKeydown = ({ key }: KeyboardEvent) => {\n    if (key === 'Escape') this.reset();\n  };\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('keydown', this.handleKeydown);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    window.removeEventListener('keydown', this.handleKeydown);\n  }\n\n  updated(changedProperties: Map<string, any>) {\n    if (!changedProperties.has('doc')) return;\n    const sldNsPrefix = this.doc.documentElement.lookupPrefix(sldNs);\n    if (sldNsPrefix) this.nsp = sldNsPrefix;\n    else\n      this.doc.documentElement.setAttributeNS(\n        xmlnsNs,\n        `xmlns:${this.nsp}`,\n        sldNs\n      );\n\n  }\n\n  reset() {\n    this.resizingBR = undefined;\n    this.resizingTL = undefined;\n    this.placing = undefined;\n    this.placingLabel = undefined;\n    this.connecting = undefined;\n    this.dispatchEvent(new CustomEvent('sld-editor-in-action', { detail: false }));\n  }\n\n  resetWithOffset() {\n    this.placingOffset = [0, 0];\n    this.reset();\n  }\n\n  startResizingBottomRight(element: Element | undefined) {\n    this.reset();\n    this.resizingBR = element;\n    this.dispatchEvent(new CustomEvent('sld-editor-in-action', { detail: true }));\n  }\n\n  startResizingTopLeft(element: Element | undefined) {\n    this.reset();\n    this.resizingTL = element;\n    this.dispatchEvent(new CustomEvent('sld-editor-in-action', { detail: true }));\n  }\n\n  startPlacing(element: Element | undefined, offset: Point = [0, 0]) {\n    if (this.disabled) return;\n\n    this.reset();\n    this.placing = element;\n    this.placingOffset = offset;\n    this.dispatchEvent(new CustomEvent('sld-editor-in-action', { detail: true }));\n  }\n\n  startPlacingLabel(element: Element | undefined, offset: Point = [0, 0]) {\n    this.reset();\n    this.placingLabel = element;\n    this.placingOffset = offset;\n    this.dispatchEvent(new CustomEvent('sld-editor-in-action', { detail: true }));\n  }\n\n  startConnecting(detail: StartConnectDetail) {\n    this.reset();\n    this.connecting = detail;\n    this.dispatchEvent(new CustomEvent('sld-editor-in-action', { detail: true }));\n  }\n\n  rotateElement(element: Element) {\n    const { rot } = attributes(element);\n    const edits = [\n      updateSLDAttributes(element, this.nsp, {\n        rot: ((rot + 1) % 4).toString(),\n      }),\n    ];\n    if (\n      element.tagName === 'ConductingEquipment' ||\n      element.tagName === 'PowerTransformer'\n    ) {\n      Array.from(element.querySelectorAll('Terminal, NeutralPoint'))\n        .filter(terminal => terminal.getAttribute('cNodeName') !== 'grounded')\n        .forEach(terminal => edits.push(...removeTerminal(terminal)));\n    }\n    this.dispatchEvent(newEditEventV2(edits));\n  }\n\n  placeLabel(element: Element, x: number, y: number) {\n    const editV2 = updateSLDAttributes(element, this.nsp, {\n      lx: x.toString(),\n      ly: y.toString(),\n    });\n    this.dispatchEvent(newEditEventV2(editV2));\n    this.reset();\n  }\n\n  placeElement(element: Element, parent: Element, x: number, y: number) {\n    const edits: EditV2[] = [];\n    if (element.parentElement !== parent) {\n      edits.push(...reparentElement(element, parent));\n    }\n\n    const {\n      pos: [oldX, oldY],\n      label: [oldLX, oldLY],\n      rot,\n    } = attributes(element);\n\n    const dx = x - oldX;\n    const dy = y - oldY;\n\n    if (element.localName !== 'Vertex') {\n      let lx = oldLX;\n      let ly = oldLY;\n      if (\n        element.tagName === 'ConductingEquipment' &&\n        !getSLDAttributes(element, 'lx') &&\n        rot % 2 === 0\n      ) {\n        lx += 1;\n        ly += 1;\n      }\n      if (\n        element.tagName === 'PowerTransformer' &&\n        !getSLDAttributes(element, 'lx')\n      ) {\n        if (rot < 2) lx += 1.5;\n        else {\n          lx -= 2;\n          ly += 2;\n        }\n      }\n      edits.push(\n        updateSLDAttributes(element, this.nsp, {\n          x: x.toString(),\n          y: y.toString(),\n          lx: (lx + dx).toString(),\n          ly: (ly + dy).toString(),\n        })\n      );\n    }\n\n    Array.from(element.querySelectorAll('Text')).forEach(text => {\n      const {\n        label: [textLX, textLY],\n      } = attributes(text);\n\n      const newAttr = {\n        lx: (textLX + dx).toString(),\n        ly: (textLY + dy).toString(),\n      };\n      edits.push(updateSLDAttributes(text, this.nsp, newAttr));\n    });\n\n    Array.from(\n      element.querySelectorAll(\n        'Bay, ConductingEquipment, PowerTransformer, Vertex'\n      )\n    ).forEach(descendant => {\n      const {\n        pos: [descX, descY],\n        label: [descLX, descLY],\n      } = attributes(descendant);\n      const newAttributes: { x: string; y: string; lx?: string; ly?: string } =\n      {\n        x: (descX + dx).toString(),\n        y: (descY + dy).toString(),\n      };\n      if (descendant.localName !== 'Vertex') {\n        newAttributes.lx = (descLX + dx).toString();\n        newAttributes.ly = (descLY + dy).toString();\n      }\n      edits.push(updateSLDAttributes(descendant, this.nsp, newAttributes));\n    });\n\n    if (\n      element.tagName === 'ConductingEquipment' ||\n      element.tagName === 'PowerTransformer'\n    ) {\n      Array.from(element.querySelectorAll('Terminal, NeutralPoint'))\n        .filter(terminal => terminal.getAttribute('cNodeName') !== 'grounded')\n        .forEach(terminal => edits.push(...removeTerminal(terminal)));\n\n      const groundedTerminals = Array.from(\n        element.querySelectorAll('Terminal, NeutralPoint')\n      ).filter(terminal => terminal.getAttribute('cNodeName') === 'grounded');\n\n      if (groundedTerminals.length > 0) {\n        const bayName = parent.closest('Bay')?.getAttribute('name');\n        if (!bayName)\n          groundedTerminals.forEach(terminal =>\n            edits.push(...removeTerminal(terminal))\n          );\n\n        let newCNode = parent.querySelector(\n          `ConnectivityNode[name=\"grounded\"]`\n        );\n\n        if (!newCNode) {\n          newCNode = this.doc.createElementNS(\n            this.doc.documentElement.namespaceURI,\n            'ConnectivityNode'\n          );\n          newCNode.setAttribute('name', 'grounded');\n          newCNode.setAttribute('pathName', elementPath(parent, 'grounded'));\n\n          edits.push({\n            node: newCNode,\n            parent,\n            reference: getReference(parent, 'ConnectivityNode'),\n          });\n        }\n\n        const voltageLevelName = parent\n          .closest('VoltageLevel')\n          ?.getAttribute('name');\n        const substationName = parent\n          .closest('Substation')!\n          .getAttribute('name')!;\n        const connectivityNode = newCNode!.getAttribute('pathName');\n\n        groundedTerminals.forEach(terminal => {\n          edits.push({\n            element: terminal,\n            attributes: {\n              connectivityNode,\n              bayName,\n              voltageLevelName,\n              substationName,\n            },\n          });\n        });\n      }\n    } else if (element.getRootNode() === this.doc) {\n      Array.from(element.getElementsByTagName('ConnectivityNode')).forEach(\n        cNode => {\n          if (\n            Array.from(\n              this.doc.querySelectorAll(\n                `Terminal[connectivityNode=\"${cNode.getAttribute('pathName')}\"],\n                     NeutralPoint[connectivityNode=\"${cNode.getAttribute(\n                  'pathName'\n                )}\"]`\n              )\n            ).find(terminal => terminal.closest(element.tagName) !== element)\n          )\n            edits.push(...removeNode(cNode));\n        }\n      );\n      Array.from(element.querySelectorAll('Terminal, NeutralPoint')).forEach(\n        terminal => {\n          const cNode = this.doc.querySelector(\n            `ConnectivityNode[pathName=\"${terminal.getAttribute(\n              'connectivityNode'\n            )}\"]`\n          );\n          if (cNode && cNode.closest(element.tagName) !== element)\n            edits.push(...removeNode(cNode));\n        }\n      );\n    }\n\n    if (element.localName === 'Vertex') {\n      const bay = element.closest('Bay')!;\n      const sections = busSections(bay);\n      const section = sections[0];\n      const vertex = section.querySelector('Vertex')!;\n      const lastSection = sections[sections.length - 1];\n      const lastVertex = lastSection.querySelector('Vertex:last-of-type')!;\n      const {\n        pos: [x1, y1],\n      } = attributes(vertex);\n      const w = x - x1 + 1;\n      const h = y - y1 + 1;\n      if (isBusBar(bay)) {\n        edits.push(...removeNode(section.closest('ConnectivityNode')!));\n        edits.push(\n          updateSLDAttributes(lastVertex, this.nsp, {\n            x: x.toString(),\n            y: y.toString(),\n          })\n        );\n        edits.push(\n          updateSLDAttributes(bay, this.nsp, {\n            w: w.toString(),\n            h: h.toString(),\n          })\n        );\n      }\n    }\n\n    this.dispatchEvent(newEditEventV2(edits));\n    if (\n      ['Bay', 'VoltageLevel'].includes(element.tagName) &&\n      (!getSLDAttributes(element, 'w') || !getSLDAttributes(element, 'h'))\n    )\n      this.startResizingBottomRight(element);\n    else this.reset();\n  }\n\n  connectEquipment({\n    from,\n    fromTerminal,\n    to,\n    toTerminal,\n    path,\n  }: ConnectDetail) {\n    if (\n      from.tagName === 'TransformerWinding' &&\n      to.tagName === 'TransformerWinding'\n    )\n      return;\n    const edits = [] as EditV2[];\n    let cNode: Element;\n    let connectivityNode: string;\n    let cNodeName: string;\n    let priv: Element;\n    if (to.tagName !== 'ConnectivityNode') {\n      cNode = this.doc.createElementNS(\n        this.doc.documentElement.namespaceURI,\n        'ConnectivityNode'\n      );\n      cNode.setAttribute('name', 'L1');\n      const bay = from.closest('Bay') || to.closest('Bay')!;\n      edits.push(...reparentElement(cNode, bay));\n      connectivityNode = (\n        edits.find(\n          e => 'attributes' in e && 'pathName' in e.attributes!\n        ) as SetAttributes\n      ).attributes!.pathName as string;\n      cNodeName =\n        ((\n          edits.find(\n            e => 'attributes' in e && 'name' in e.attributes!\n          ) as SetAttributes\n        )?.attributes!.name as string | undefined) ??\n        cNode.getAttribute('name')!;\n      priv = this.doc.createElementNS(\n        this.doc.documentElement.namespaceURI,\n        'Private'\n      );\n      priv.setAttribute('type', privType);\n      edits.push({\n        parent: cNode,\n        node: priv,\n        reference: getReference(cNode, 'Private'),\n      });\n    } else {\n      cNode = to;\n      connectivityNode = cNode.getAttribute('pathName')!;\n      cNodeName = cNode.getAttribute('name')!;\n      priv = cNode.querySelector(`Private[type=\"${privType}\"]`)!;\n    }\n    const section = this.doc.createElementNS(sldNs, `${this.nsp}:Section`);\n    edits.push({ parent: priv!, node: section, reference: null });\n    const fromTermUUID = uuid();\n    const toTermUUID = uuid();\n    path.forEach(([x, y], i) => {\n      const vertex = this.doc.createElementNS(sldNs, `${this.nsp}:Vertex`);\n      setSLDAttributes(vertex, this.nsp, { x: x.toString(), y: y.toString() });\n      if (i === 0) setSLDAttributes(vertex, this.nsp, { uuid: fromTermUUID });\n      else if (i === path.length - 1 && to.tagName !== 'ConnectivityNode')\n        setSLDAttributes(vertex, this.nsp, { uuid: toTermUUID });\n      edits.push({ parent: section, node: vertex, reference: null });\n    });\n    if (to.tagName === 'ConnectivityNode') {\n      const [x, y] = path[path.length - 1];\n      Array.from(priv.getElementsByTagNameNS(sldNs, 'Section')).find(s => {\n        const sectionPath = Array.from(\n          s.getElementsByTagNameNS(sldNs, 'Vertex')\n        ).map(v => attributes(v).pos);\n        for (let i = 0; i < sectionPath.length - 1; i += 1) {\n          const [x0, y0] = sectionPath[i];\n          const [x1, y1] = sectionPath[i + 1];\n          if (\n            (y0 === y &&\n              y === y1 &&\n              ((x0 < x && x < x1) || (x1 < x && x < x0))) ||\n            (x0 === x &&\n              x === x1 &&\n              ((y0 < y && y < y1) || (y1 < y && y < y0))) ||\n            (y0 === y && x0 === x)\n          ) {\n            edits.push(cutSectionAt(s, i, [x, y], this.nsp));\n            return true;\n          }\n        }\n        return false;\n      });\n    }\n    const [substationName, voltageLevelName, bayName] = connectivityNode.split(\n      '/',\n      3\n    );\n    const fromTagName = fromTerminal.startsWith('T')\n      ? 'Terminal'\n      : 'NeutralPoint';\n    const fromTermElement = this.doc.createElementNS(\n      this.doc.documentElement.namespaceURI,\n      fromTagName\n    );\n    setSLDAttributes(fromTermElement, this.nsp, { uuid: fromTermUUID });\n    fromTermElement.setAttribute('name', fromTerminal);\n    fromTermElement.setAttribute('connectivityNode', connectivityNode);\n    fromTermElement.setAttribute('substationName', substationName);\n    fromTermElement.setAttribute('voltageLevelName', voltageLevelName);\n    fromTermElement.setAttribute('bayName', bayName);\n    fromTermElement.setAttribute('cNodeName', cNodeName);\n    edits.push({\n      node: fromTermElement,\n      parent: from,\n      reference: getReference(from, fromTagName),\n    });\n    if (to.tagName === 'ConductingEquipment') {\n      const toTagName = toTerminal!.startsWith('T')\n        ? 'Terminal'\n        : 'NeutralPoint';\n      const toTermElement = this.doc.createElementNS(\n        this.doc.documentElement.namespaceURI,\n        toTagName\n      );\n      setSLDAttributes(toTermElement, this.nsp, { uuid: toTermUUID });\n      toTermElement.setAttribute('name', toTerminal!);\n      toTermElement.setAttribute('connectivityNode', connectivityNode);\n      toTermElement.setAttribute('substationName', substationName);\n      toTermElement.setAttribute('voltageLevelName', voltageLevelName);\n      toTermElement.setAttribute('bayName', bayName);\n      toTermElement.setAttribute('cNodeName', cNodeName);\n      edits.push({\n        node: toTermElement,\n        parent: to,\n        reference: getReference(to, toTagName),\n      });\n    }\n    this.reset();\n    this.dispatchEvent(newEditEventV2(edits));\n  }\n\n  render(): unknown {\n    return html`${Array.from(\n      this.doc.querySelectorAll(':root > Substation')\n    ).map(\n      subs =>\n        html`<sld-substation-editor\n          .doc=${this.doc}\n          .docVersion=${this.docVersion}\n          .substation=${subs}\n          .gridSize=${this.gridSize}\n          .resizingBR=${this.resizingBR}\n          .resizingTL=${this.resizingTL}\n          .placing=${this.placing}\n          .placingOffset=${this.placingOffset}\n          .placingLabel=${this.placingLabel}\n          .connecting=${this.connecting}\n          .showLabels=${this.showLabels}\n          .disabled=${this.disabled}\n          @oscd-sld-start-resize-br=${({ detail }: StartEvent) => {\n            this.startResizingBottomRight(detail);\n          }}\n          @oscd-sld-start-resize-tl=${({ detail }: StartEvent) => {\n            this.startResizingTopLeft(detail);\n          }}\n          @oscd-sld-start-place=${({\n            detail: { element, offset },\n          }: StartPlaceEvent) => {\n            this.startPlacing(element, offset);\n          }}\n          @oscd-sld-start-place-label=${({\n            detail: { element, offset },\n          }: StartPlaceEvent) => {\n            this.startPlacingLabel(element, offset);\n          }}\n          @oscd-sld-start-connect=${({ detail }: StartConnectEvent) => {\n            this.startConnecting(detail);\n          }}\n          @oscd-sld-resize=${({ detail: { element, w, h } }: ResizeEvent) => {\n            const resize = updateSLDAttributes(element, this.nsp, {\n              w: w.toString(),\n              h: h.toString(),\n            });\n            this.dispatchEvent(newEditEventV2(resize));\n            this.reset();\n          }}\n          @oscd-sld-resize-tl=${({\n            detail: { element, x, y, w, h },\n          }: ResizeTLEvent) => {\n            const {\n              pos: [oldX, oldY],\n              label: [oldLX, oldLY],\n            } = attributes(element);\n            let lx = oldLX;\n            let ly = oldLY;\n            if (lx === oldX && ly === oldY) {\n              lx += x - oldX;\n              ly += y - oldY;\n            }\n\n            const resize = updateSLDAttributes(element, this.nsp, {\n              x: x.toString(),\n              y: y.toString(),\n              w: w.toString(),\n              h: h.toString(),\n              lx: lx.toString(),\n              ly: ly.toString(),\n            });\n\n            this.dispatchEvent(newEditEventV2(resize));\n            this.reset();\n          }}\n          @oscd-sld-place=${({\n            detail: { element, parent, x, y },\n          }: PlaceEvent) => this.placeElement(element, parent, x, y)}\n          @oscd-sld-place-label=${({\n            detail: { element, x, y },\n          }: PlaceLabelEvent) => this.placeLabel(element, x, y)}\n          @oscd-sld-connect=${({ detail }: ConnectEvent) =>\n            this.connectEquipment(detail)}\n          @oscd-sld-rotate=${({ detail }: StartEvent) =>\n            this.rotateElement(detail)}\n        ></sld-substation-editor>`\n    )}`;\n  }\n}\n"]}